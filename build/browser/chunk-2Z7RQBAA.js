import{a as B}from"./chunk-SE2LHW5U.js";import{b as V,c as w,e as I,f as z,g as D,i as N,j as A,l as R,m as j,s as U,v as G,w as W,x as q}from"./chunk-LTEV2KH7.js";import{i as T,q as L}from"./chunk-NKZL4UVF.js";import{$b as C,Fb as x,Hb as f,Ib as v,Oa as a,Pc as k,Qc as S,Rc as E,Ub as O,Wb as r,Yb as _,Yc as F,Za as b,ac as M,bc as P,db as y,ha as m,ia as c,ib as h,vb as d,wb as n,xb as i,yb as u}from"./chunk-S4NM23YD.js";import"./chunk-CSTXWUWE.js";function H(l,t){if(l&1){let o=x();n(0,"div",42),r(1),n(2,"button",43),f("click",function(){let s=m(o).$implicit,g=v();return c(g.closeToast(s))}),r(3,"\xD7"),i()()}if(l&2){let o=t.$implicit;O("show",o.visible),d("ngClass",o.type),a(),_(" ",o.message," ")}}function J(l,t){l&1&&u(0,"span",44)}function K(l,t){if(l&1&&(n(0,"div",45),r(1),i()),l&2){let o=v();a(),_(" ",o.errorMessage," ")}}function Q(l,t){l&1&&(n(0,"small",46),r(1," \u26A0\uFE0F Veuillez entrer une adresse e-mail valide. "),i())}var Y=class l{constructor(t,o,e,s){this.authService=t;this.router=o;this.fb=e;this.userService=s}email="";motDePasse="";isLoading=!1;errorMessage="";forgotPasswordForm;serverErrors=[];toasts=[];showToast(t,o="success"){let e={message:t,type:o,visible:!1};this.toasts.push(e),requestAnimationFrame(()=>{e.visible=!0}),e.timeout=setTimeout(()=>this.closeToast(e),3e3)}closeToast(t){clearTimeout(t.timeout),t.visible=!1,setTimeout(()=>{this.toasts=this.toasts.filter(o=>o!==t)},400)}ngOnInit(){this.forgotPasswordForm=this.fb.group({email:["",[w.required,w.email]]})}closeForgotPasswordModal(){this.forgotPasswordForm.reset(),this.serverErrors=[],$("#forgotPasswordModal").modal("hide")}submitForgotPassword(){if(this.forgotPasswordForm.invalid)return;let t=this.forgotPasswordForm.value.email;this.serverErrors=[],this.userService.forgotPassword(t).subscribe({next:o=>{o&&o.message?(this.showToast([o.message],"success"),this.closeForgotPasswordModal()):this.showToast(["Une erreur est survenue"],"error")},error:o=>{this.serverErrors.push(o.error?.message||"Erreur inconnue."),this.showToast(this.serverErrors,"error")}})}openPasswordModal(){this.forgotPasswordForm.reset(),this.serverErrors=[],$("#forgotPasswordModal").modal("show")}onSubmit(){if(!this.email||!this.motDePasse){this.errorMessage="Veuillez remplir tous les champs";return}this.isLoading=!0,this.errorMessage="",console.log("success = start"),this.authService.login(this.email,this.motDePasse).subscribe({next:t=>{this.isLoading=!1,t?this.router.navigate(["/dashboard"]):this.errorMessage="Email ou mot de passe incorrect"},error:t=>{this.isLoading=!1,console.error("Erreur de connexion:",t),console.log("success = ",t),t.error&&t.error.message?this.errorMessage=t.error.message:t.status===401?this.errorMessage="Email ou mot de passe incorrect":t.status===0?this.errorMessage="Impossible de se connecter au serveur. V\xE9rifiez votre connexion.":this.errorMessage="Une erreur est survenue lors de la connexion"}})}static \u0275fac=function(o){return new(o||l)(b(L),b(T),b(G),b(B))};static \u0275cmp=y({type:l,selectors:[["app-login"]],decls:57,vars:10,consts:[["loginForm","ngForm"],[1,"toast-container"],["class","toast",3,"ngClass","show",4,"ngFor","ngForOf"],[1,"background-animated"],[1,"login-box"],[1,"login-logo"],["href","#"],[1,"card"],[1,"card-body","login-card-body"],[1,"login-box-msg"],[3,"ngSubmit"],[1,"input-group","mb-3"],["type","email","placeholder","Email","name","email","required","",1,"form-control",3,"ngModelChange","ngModel"],[1,"input-group-append"],[1,"input-group-text"],[1,"fas","fa-envelope"],["type","password","placeholder","Mot de passe","name","motDePasse","required","",1,"form-control",3,"ngModelChange","ngModel"],[1,"fas","fa-lock"],[1,"row"],[1,"col-8"],[1,"icheck-primary"],["type","checkbox","id","remember"],["for","remember"],[1,"col-4"],["type","submit",1,"btn","btn-primary","btn-block",3,"disabled"],["class","spinner-border spinner-border-sm mr-2",4,"ngIf"],["class","alert alert-danger mt-3",4,"ngIf"],[1,"mb-1"],[1,"clickable-link",3,"click"],["id","forgotPasswordModal","tabindex","-1","role","dialog",1,"modal","fade"],["role","document",1,"modal-dialog","modal-dialog-centered"],[1,"modal-content"],[1,"modal-header","bg-warning"],[1,"modal-title"],[1,"modal-body"],[3,"formGroup"],[1,"form-group"],["type","email","formControlName","email","placeholder","Entrez votre e-mail",1,"form-control"],["class","text-danger",4,"ngIf"],[1,"modal-footer"],["type","button","data-bs-dismiss","modal",1,"btn","btn-secondary",3,"click"],[1,"btn","btn-warning",3,"click","disabled"],[1,"toast",3,"ngClass"],[1,"close-btn",3,"click"],[1,"spinner-border","spinner-border-sm","mr-2"],[1,"alert","alert-danger","mt-3"],[1,"text-danger"]],template:function(o,e){if(o&1){let s=x();n(0,"div",1),h(1,H,4,4,"div",2),i(),n(2,"div",3)(3,"div",4)(4,"div",5)(5,"a",6)(6,"b"),r(7,"SCI"),i(),r(8," Mermo"),i()(),n(9,"div",7)(10,"div",8)(11,"p",9),r(12,"Connectez-vous pour commencer votre session"),i(),n(13,"form",10,0),f("ngSubmit",function(){return m(s),c(e.onSubmit())}),n(15,"div",11)(16,"input",12),P("ngModelChange",function(p){return m(s),M(e.email,p)||(e.email=p),c(p)}),i(),n(17,"div",13)(18,"div",14),u(19,"span",15),i()()(),n(20,"div",11)(21,"input",16),P("ngModelChange",function(p){return m(s),M(e.motDePasse,p)||(e.motDePasse=p),c(p)}),i(),n(22,"div",13)(23,"div",14),u(24,"span",17),i()()(),n(25,"div",18)(26,"div",19)(27,"div",20),u(28,"input",21),n(29,"label",22),r(30," Se souvenir de moi "),i()()(),n(31,"div",23)(32,"button",24),h(33,J,1,0,"span",25),r(34),i()()()(),h(35,K,2,1,"div",26),n(36,"p",27)(37,"a",28),f("click",function(){return m(s),c(e.openPasswordModal())}),r(38,"J'ai oubli\xE9 mon mot de passe"),i()()()()()(),n(39,"div",29)(40,"div",30)(41,"div",31)(42,"div",32)(43,"h5",33),r(44,"Mot de passe oubli\xE9"),i()(),n(45,"div",34)(46,"form",35)(47,"div",36)(48,"label"),r(49,"Adresse e-mail"),i(),u(50,"input",37),h(51,Q,2,0,"small",38),i()()(),n(52,"div",39)(53,"button",40),f("click",function(){return m(s),c(e.closeForgotPasswordModal())}),r(54,"Annuler"),i(),n(55,"button",41),f("click",function(){return m(s),c(e.submitForgotPassword())}),r(56," Reinitialiser "),i()()()()()}if(o&2){let s;a(),d("ngForOf",e.toasts),a(15),C("ngModel",e.email),a(5),C("ngModel",e.motDePasse),a(11),d("disabled",e.isLoading),a(),d("ngIf",e.isLoading),a(),_(" ",e.isLoading?"Connexion...":"Connexion"," "),a(),d("ngIf",e.errorMessage),a(11),d("formGroup",e.forgotPasswordForm),a(5),d("ngIf",((s=e.forgotPasswordForm.get("email"))==null?null:s.invalid)&&((s=e.forgotPasswordForm.get("email"))==null?null:s.touched)),a(4),d("disabled",e.forgotPasswordForm.invalid)}},dependencies:[F,k,S,E,q,A,V,I,z,U,R,j,W,N,D],styles:[".background-animated[_ngcontent-%COMP%]{min-height:100vh;display:flex;align-items:center;justify-content:center;padding:20px;position:absolute;top:0;left:0;width:100%;height:100%;background:linear-gradient(270deg,#667eea,#764ba2,#43cea2,#185a9d);background-size:800% 800%;animation:_ngcontent-%COMP%_gradientShift 20s ease infinite;z-index:-1}@keyframes _ngcontent-%COMP%_gradientShift{0%{background-position:0% 50%}50%{background-position:100% 50%}to{background-position:0% 50%}}.login-page[_ngcontent-%COMP%]{min-height:100vh;background:linear-gradient(135deg,#f0f1f3,#764ba2);display:flex;align-items:center;justify-content:center;padding:20px}.login-box[_ngcontent-%COMP%]{width:100%;max-width:450px;margin:0 auto}.login-logo[_ngcontent-%COMP%]{text-align:center;margin-bottom:30px}.login-logo[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{font-size:2.5rem;font-weight:700;color:#fff;text-decoration:none;text-shadow:2px 2px 4px rgba(0,0,0,.3)}.card[_ngcontent-%COMP%]{border-radius:15px;box-shadow:0 15px 35px #0000001a;border:none;overflow:hidden}.login-card-body[_ngcontent-%COMP%]{padding:40px 50px;background:#fff}.login-box-msg[_ngcontent-%COMP%]{font-size:1.2rem;color:#666;margin-bottom:30px;text-align:center;font-weight:500}.input-group[_ngcontent-%COMP%]{margin-bottom:25px}.form-control[_ngcontent-%COMP%]{height:55px;font-size:1.1rem;padding:15px 20px;border-radius:10px;border:2px solid #e1e5e9;transition:all .3s ease}.form-control[_ngcontent-%COMP%]:focus{border-color:#667eea;box-shadow:0 0 0 .2rem #667eea40;transform:translateY(-2px)}.input-group-text[_ngcontent-%COMP%]{background:#f8f9fa;border:2px solid #e1e5e9;border-left:none;border-radius:0 10px 10px 0;padding:15px 20px;transition:all .3s ease}.input-group[_ngcontent-%COMP%]:focus-within   .input-group-text[_ngcontent-%COMP%]{border-color:#667eea;background:#667eea;color:#fff}.input-group[_ngcontent-%COMP%]:focus-within   .input-group-text[_ngcontent-%COMP%]   .fas[_ngcontent-%COMP%]{color:#fff}.btn-primary[_ngcontent-%COMP%]{height:55px;font-size:1.1rem;font-weight:600;border-radius:10px;padding:15px 30px;background:linear-gradient(135deg,#667eea,#764ba2);border:none;transition:all .3s ease;text-transform:uppercase;letter-spacing:1px}.btn-primary[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 10px 25px #667eea66}.btn-primary[_ngcontent-%COMP%]:disabled{opacity:.7;transform:none}.icheck-primary[_ngcontent-%COMP%]{margin-top:5px}.icheck-primary[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{width:20px;height:20px;margin-right:10px}.icheck-primary[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:1rem;color:#666;cursor:pointer}.login-card-body[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{font-size:1rem;color:#667eea;text-decoration:none;transition:color .3s ease}.login-card-body[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:#764ba2;text-decoration:underline}.alert[_ngcontent-%COMP%]{font-size:1rem;padding:15px 20px;border-radius:10px;margin-top:20px}@media (max-width: 576px){.login-card-body[_ngcontent-%COMP%]{padding:30px 25px}.login-logo[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{font-size:2rem}.form-control[_ngcontent-%COMP%], .btn-primary[_ngcontent-%COMP%]{height:50px;font-size:1rem}}@keyframes _ngcontent-%COMP%_slideInUp{0%{opacity:0;transform:translateY(30px)}to{opacity:1;transform:translateY(0)}}.card[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_slideInUp .6s ease-out}.card[_ngcontent-%COMP%]:hover{transform:translateY(-5px);transition:transform .3s ease}.text-danger[_ngcontent-%COMP%]{font-size:.85rem;margin-top:2px;display:block}.toast-container[_ngcontent-%COMP%]{position:fixed;top:20px;right:20px;display:flex;flex-direction:column;gap:10px;z-index:9999}.toast[_ngcontent-%COMP%]{min-width:220px;padding:12px 16px;border-radius:6px;color:#fff;box-shadow:0 4px 12px #00000040;font-size:14px;display:flex;justify-content:space-between;align-items:center;opacity:0;transform:translate(100%);transition:transform .4s ease,opacity .4s ease}.toast.show[_ngcontent-%COMP%]{opacity:1;transform:translate(0)}.toast.success[_ngcontent-%COMP%]{background-color:#4caf50}.toast.error[_ngcontent-%COMP%]{background-color:#f44336}.toast[_ngcontent-%COMP%]   .close-btn[_ngcontent-%COMP%]{background:none;border:none;color:#fff;font-size:16px;line-height:1;cursor:pointer}.clickable-link[_ngcontent-%COMP%]{cursor:pointer;color:#007bff;text-decoration:underline}.clickable-link[_ngcontent-%COMP%]:hover{color:#0056b3}"]})};export{Y as LoginComponent};
