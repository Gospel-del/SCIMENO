import{y as c}from"./chunk-LTEV2KH7.js";import{c as u,q as m}from"./chunk-NKZL4UVF.js";import{B as n,Z as h,ba as l,g as p,l as i,p as o}from"./chunk-S4NM23YD.js";var s=class r{idClient;nom;prenom;email;entreprise;telephone;statut;created_at;updated_at;constructor(e){this.idClient=e.idClient,this.nom=e.nom,this.prenom=e.prenom,this.email=e.email,this.entreprise=e.entreprise,this.telephone=e.telephone,this.statut=e.statut,this.created_at=e.created_at,this.updated_at=e.updated_at}toDict(){return{idClient:this.idClient,nom:this.nom,prenom:this.prenom,email:this.email,entreprise:this.entreprise,telephone:this.telephone,statut:this.statut,created_at:this.created_at,updated_at:this.updated_at}}getFullName(){return`${this.prenom} ${this.nom}`}isActive(){return this.statut}softDelete(){this.statut=!1,this.updated_at=new Date().toISOString()}updateInfo(e){e.nom!==void 0&&(this.nom=e.nom),e.prenom!==void 0&&(this.prenom=e.prenom),e.email!==void 0&&(this.email=e.email),e.entreprise!==void 0&&(this.entreprise=e.entreprise),e.telephone!==void 0&&(this.telephone=e.telephone),e.statut!==void 0&&(this.statut=e.statut),this.updated_at=new Date().toISOString()}isValidate(){let e=[];return(!this.nom||this.nom.trim().length===0)&&e.push("Le nom est requis"),!this.email||this.email.trim().length===0?e.push("L'email est requis"):this.isValidEmail(this.email)||e.push("L'email n'est pas valide"),{isValid:e.length===0,errors:e}}isValidEmail(e){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)}static fromCreateData(e){let t=new Date().toISOString();return new r({idClient:0,nom:e.nom,prenom:e.prenom,email:e.email,entreprise:e.entreprise,telephone:e.telephone,statut:e.statut??!0,created_at:t,updated_at:t})}static fromResponse(e){return new r({idClient:e.idClient,nom:e.nom,prenom:e.prenom,email:e.email,entreprise:e.entreprise,telephone:e.telephone,statut:e.statut,created_at:e.created_at,updated_at:e.updated_at})}};var d=class r{constructor(e,t,a){this.http=e;this.authService=t;this.authHelper=a}apiUrl="http://localhost:5000/api/clients";currentUserSubject=new p(null);currentUser$=this.currentUserSubject.asObservable();_clientToEdit=null;setClientToEdit(e){this._clientToEdit=e}getClientToEdit(){return this._clientToEdit}clearClientToEdit(){this._clientToEdit=null}getAuthHeaders(){return this.authHelper.getAuthHeaders("ClientService")}createClient(e){return this.getAuthHeaders()?this.http.post(`${this.apiUrl}/creer_client`,e,this.getAuthHeaders()).pipe(o(t=>{if(t.success&&t.data)return s.fromResponse(t.data);throw new Error(t.message||"Erreur lors du client")}),n(t=>this.handleError(t,null))):i(null)}updateClient(e){return this.getAuthHeaders()?this.http.post(`${this.apiUrl}/modifier_client`,e,this.getAuthHeaders()).pipe(o(t=>{if(t.success&&t.data)return s.fromResponse(t.data);throw new Error(t.message||"Erreur lors de la modification du client")}),n(t=>this.handleError(t,null))):i(null)}deleteClient(e){return this.getAuthHeaders()?this.http.post(`${this.apiUrl}/supprimer_client`,{idClient:e.idClient},this.getAuthHeaders()).pipe(n(t=>this.handleError(t,null))):i(null)}searchClient(e){return this.getAuthHeaders()?this.http.post(`${this.apiUrl}/rechercher_clients`,{terme_recherche:e},this.getAuthHeaders()).pipe(n(t=>this.handleError(t,null))):i(null)}listClients(e,t,a){if(!this.getAuthHeaders())return i(null);let g={page:e,size:t,recherche:a};return this.http.post(`${this.apiUrl}/lister_clients`,g,this.getAuthHeaders()).pipe(n(C=>this.handleError(C,null)))}handleError(e,t){return console.error("Erreur dans ScenariosService:",e),e.error&&e.error.message&&console.error("Message d'erreur:",e.error.message),e.status===401&&console.warn("Token expir\xE9 ou invalide"),i(t)}static \u0275fac=function(t){return new(t||r)(l(u),l(m),l(c))};static \u0275prov=h({token:r,factory:r.\u0275fac,providedIn:"root"})};export{s as a,d as b};
