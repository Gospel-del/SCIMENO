import{y as b}from"./chunk-LTEV2KH7.js";import{c as h,q as m}from"./chunk-NKZL4UVF.js";import{B as i,Z as d,ba as l,g as _,l as n,p as u}from"./chunk-S4NM23YD.js";var o=class c{id_scenario;nom_scenario;coef_majoration;description;status;actif;created_at;updated_at;constructor(e){this.id_scenario=e.id_scenario,this.nom_scenario=e.nom_scenario,this.coef_majoration=e.coef_majoration,this.description=e.description,this.status=e.status,this.actif=e.actif,this.created_at=e.created_at,this.updated_at=e.updated_at}toDict(){return{id_scenario:this.id_scenario,nom_scenario:this.nom_scenario,coef_majoration:this.coef_majoration,description:this.description,status:this.status,actif:this.actif,created_at:this.created_at,updated_at:this.updated_at}}static fromResponse(e){return new c({id_scenario:e.id_scenario,nom_scenario:e.nom_scenario,coef_majoration:e.coef_majoration,description:e.description,status:e.status,actif:e.actif,created_at:e.created_at,updated_at:e.updated_at})}isActive(){return this.status&&this.actif}getFormattedCoefficient(){return`${(this.coef_majoration*100).toFixed(2)}%`}},f=class c{id_scenario_sous_nature;id_scenario;id_sous_nature;coefficient;valeur_calculee;created_at;updated_at;scenario_nom;sous_nature_nom;sous_nature_nature_nom;constructor(e){this.id_scenario_sous_nature=e.id_scenario_sous_nature,this.id_scenario=e.id_scenario,this.id_sous_nature=e.id_sous_nature,this.coefficient=e.coefficient,this.valeur_calculee=e.valeur_calculee,this.created_at=e.created_at,this.updated_at=e.updated_at,this.scenario_nom=e.scenario_nom,this.sous_nature_nom=e.sous_nature_nom,this.sous_nature_nature_nom=e.sous_nature_nature_nom}toDict(){return{id_scenario_sous_nature:this.id_scenario_sous_nature,id_scenario:this.id_scenario,id_sous_nature:this.id_sous_nature,coefficient:this.coefficient,valeur_calculee:this.valeur_calculee,created_at:this.created_at,updated_at:this.updated_at,scenario_nom:this.scenario_nom,sous_nature_nom:this.sous_nature_nom,sous_nature_nature_nom:this.sous_nature_nature_nom}}static fromResponse(e){return new c({id_scenario_sous_nature:e.id_scenario_sous_nature,id_scenario:e.id_scenario,id_sous_nature:e.id_sous_nature,coefficient:e.coefficient,valeur_calculee:e.valeur_calculee,created_at:e.created_at,updated_at:e.updated_at,scenario_nom:e.scenario_nom,sous_nature_nom:e.sous_nature_nom,sous_nature_nature_nom:e.sous_nature_nature_nom})}getFormattedCoefficient(){return this.coefficient===void 0||this.coefficient===null?"N/A":`${(this.coefficient*100).toFixed(2)}%`}getFormattedValeurCalculee(){return this.valeur_calculee===void 0||this.valeur_calculee===null?"N/A":this.valeur_calculee.toFixed(2)}};var S=class c{constructor(e,t,r){this.http=e;this.authService=t;this.authHelper=r}apiUrl="http://localhost:5000/api/scenario";currentScenarioSubject=new _(null);currentScenario$=this.currentScenarioSubject.asObservable();_scenarioToEdit=null;setScenarioToEdit(e){this._scenarioToEdit=e}getScenarioToEdit(){return this._scenarioToEdit}clearScenarioToEdit(){this._scenarioToEdit=null}createScenario(e){let t=this.authHelper.getAuthHeadersWithCheck("ScenariosService");return t?this.http.post(`${this.apiUrl}/creer`,e,t).pipe(u(r=>{if(r.success&&r.data)return o.fromResponse(r.data);throw new Error(r.message||"Erreur lors de la cr\xE9ation du sc\xE9nario")}),i(r=>this.handleError(r,null))):n(null)}listScenarios(e=1,t=10,r=!1){let a=this.authHelper.getAuthHeadersWithCheck("ScenariosService");if(!a)return n(null);let s={page:e,per_page:t,actif_only:r};return this.http.post(`${this.apiUrl}/lister`,s,a).pipe(i(p=>this.handleError(p,null)))}getScenarioById(e){let t=this.authHelper.getAuthHeadersWithCheck("ScenariosService");return t?this.http.post(`${this.apiUrl}/obtenir`,{id_scenario:e},t).pipe(u(r=>{if(r.success&&r.data)return o.fromResponse(r.data);throw new Error(r.message||"Sc\xE9nario non trouv\xE9")}),i(r=>this.handleError(r,null))):n(null)}updateScenario(e){let t=this.authHelper.getAuthHeadersWithCheck("ScenariosService");return t?this.http.post(`${this.apiUrl}/modifier`,e,t).pipe(u(r=>{if(r.success&&r.data)return o.fromResponse(r.data);throw new Error(r.message||"Erreur lors de la modification du sc\xE9nario")}),i(r=>this.handleError(r,null))):n(null)}searchScenarios(e){let t=this.authHelper.getAuthHeadersWithCheck("ScenariosService");return t?this.http.post(`${this.apiUrl}/rechercher`,{terme_recherche:e},t).pipe(i(r=>this.handleError(r,null))):n(null)}deleteScenario(e){let t=this.authHelper.getAuthHeadersWithCheck("ScenariosService");return t?this.http.post(`${this.apiUrl}/supprimer`,{id_scenario:e},t).pipe(i(r=>this.handleError(r,null))):n(null)}restoreScenario(e){let t=this.authHelper.getAuthHeadersWithCheck("ScenariosService");return t?this.http.post(`${this.apiUrl}/restaurer`,{id_scenario:e},t).pipe(u(r=>{if(r.success&&r.data)return o.fromResponse(r.data);throw new Error(r.message||"Erreur lors de la restauration du sc\xE9nario")}),i(r=>this.handleError(r,null))):n(null)}toggleScenario(e,t){let r=this.authHelper.getAuthHeadersWithCheck("ScenariosService");if(!r)return n(null);let a={id_scenario:e};return t!==void 0&&(a.actif=t),this.http.post(`${this.apiUrl}/activer`,a,r).pipe(u(s=>{if(s.success&&s.data)return o.fromResponse(s.data);throw new Error(s.message||"Erreur lors de l'activation/d\xE9sactivation du sc\xE9nario")}),i(s=>this.handleError(s,null)))}applyScenario(e){let t=this.authHelper.getAuthHeadersWithCheck("ScenariosService");return t?this.http.post(`${this.apiUrl}/appliquer`,e,t).pipe(i(r=>this.handleError(r,null))):n(null)}applyScenarioMultiple(e){let t=this.authHelper.getAuthHeadersWithCheck("ScenariosService");return t?this.http.post(`${this.apiUrl}/appliquer_multiple`,e,t).pipe(i(r=>this.handleError(r,null))):n(null)}cancelScenario(e,t,r=!1){let a=this.authHelper.getAuthHeadersWithCheck("ScenariosService");if(!a)return n(null);let s={id_scenario:e};return t!==void 0?(s.id_sous_nature=t,s.supprimer_entree=r):s.supprimer_entrees=r,this.http.post(`${this.apiUrl}/annuler`,s,a).pipe(i(p=>this.handleError(p,null)))}handleError(e,t){return console.error("Erreur dans ScenariosService:",e),e.error&&e.error.message&&console.error("Message d'erreur:",e.error.message),e.status===401&&console.warn("Token expir\xE9 ou invalide"),n(t)}static \u0275fac=function(t){return new(t||c)(l(h),l(m),l(b))};static \u0275prov=d({token:c,factory:c.\u0275fac,providedIn:"root"})};export{o as a,f as b,S as c};
