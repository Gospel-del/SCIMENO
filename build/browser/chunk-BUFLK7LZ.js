import{y as P}from"./chunk-LTEV2KH7.js";import{c as j,q as h}from"./chunk-NKZL4UVF.js";import{B as o,Z as d,ba as a,g as c,l as i,p as u}from"./chunk-S4NM23YD.js";var n=class s{idProjet;nomProjet;dateProjet;localisation;typeProjet;modeExploitation;statutJuridique;typeLocataireCible;dureeProjet;superficieTerrain;superficieConstruite;nombreAnneesProjet;informationsComplementaires;idClient;client_nom;statut;created_at;updated_at;constructor(e){this.idProjet=e.idProjet,this.nomProjet=e.nomProjet,this.dateProjet=e.dateProjet,this.localisation=e.localisation,this.typeProjet=e.typeProjet,this.modeExploitation=e.modeExploitation,this.statutJuridique=e.statutJuridique,this.typeLocataireCible=e.typeLocataireCible,this.dureeProjet=e.dureeProjet,this.superficieTerrain=e.superficieTerrain,this.superficieConstruite=e.superficieConstruite,this.nombreAnneesProjet=e.nombreAnneesProjet,this.informationsComplementaires=e.informationsComplementaires,this.idClient=e.idClient,this.client_nom=e.client_nom??null,this.statut=e.statut,this.created_at=e.created_at,this.updated_at=e.updated_at}toDict(){return{idProjet:this.idProjet,nomProjet:this.nomProjet,dateProjet:this.dateProjet,localisation:this.localisation,typeProjet:this.typeProjet,modeExploitation:this.modeExploitation,statutJuridique:this.statutJuridique,typeLocataireCible:this.typeLocataireCible,dureeProjet:this.dureeProjet,superficieTerrain:this.superficieTerrain,superficieConstruite:this.superficieConstruite,nombreAnneesProjet:this.nombreAnneesProjet,informationsComplementaires:this.informationsComplementaires,idClient:this.idClient,client_nom:this.client_nom??null,statut:this.statut,created_at:this.created_at,updated_at:this.updated_at}}getFullName(){return`${this.nomProjet}`}isActive(){return this.statut}softDelete(){this.statut=!1,this.updated_at=new Date().toISOString()}updateInfo(e){e.nomProjet!==void 0&&(this.nomProjet=e.nomProjet),e.dateProjet!==void 0&&(this.dateProjet=e.dateProjet),e.localisation!==void 0&&(this.localisation=e.localisation),e.typeProjet!==void 0&&(this.typeProjet=e.typeProjet),e.modeExploitation!==void 0&&(this.modeExploitation=e.modeExploitation),e.statutJuridique!==void 0&&(this.statutJuridique=e.statutJuridique),e.typeLocataireCible!==void 0&&(this.typeLocataireCible=e.typeLocataireCible),e.dureeProjet!==void 0&&(this.dureeProjet=e.dureeProjet),e.superficieTerrain!==void 0&&(this.superficieTerrain=e.superficieTerrain),e.superficieConstruite!==void 0&&(this.superficieConstruite=e.superficieConstruite),e.nombreAnneesProjet!==void 0&&(this.nombreAnneesProjet=e.nombreAnneesProjet),e.statut!==void 0&&(this.statut=e.statut),e.informationsComplementaires!==void 0&&(this.informationsComplementaires=e.informationsComplementaires),e.idClient!==void 0&&(this.idClient=e.idClient),this.updated_at=new Date().toISOString()}isValidate(){let e=[];return(!this.nomProjet||this.nomProjet.trim().length===0)&&e.push("Le nom est requis"),{isValid:e.length===0,errors:e}}static fromCreateData(e){let t=new Date().toISOString();return new s({idProjet:0,nomProjet:e.nomProjet,dateProjet:e.dateProjet,localisation:e.localisation,typeProjet:e.typeProjet,modeExploitation:e.modeExploitation,statutJuridique:e.statutJuridique,typeLocataireCible:e.typeLocataireCible,dureeProjet:e.dureeProjet,superficieTerrain:e.superficieTerrain,superficieConstruite:e.superficieConstruite,nombreAnneesProjet:e.nombreAnneesProjet,informationsComplementaires:e.informationsComplementaires,idClient:e.idClient,client_nom:e.client_nom??null,statut:e.statut??!0,created_at:t,updated_at:t})}static fromResponse(e){return new s({idProjet:e.idProjet,nomProjet:e.nomProjet,dateProjet:e.dateProjet,localisation:e.localisation,typeProjet:e.typeProjet,modeExploitation:e.modeExploitation,statutJuridique:e.statutJuridique,typeLocataireCible:e.typeLocataireCible,dureeProjet:e.dureeProjet,superficieTerrain:e.superficieTerrain,superficieConstruite:e.superficieConstruite,nombreAnneesProjet:e.nombreAnneesProjet,informationsComplementaires:e.informationsComplementaires,idClient:e.idClient,client_nom:e.client_nom,statut:e.statut,created_at:e.created_at,updated_at:e.updated_at})}};var f=class s{constructor(e,t,r){this.http=e;this.authService=t;this.authHelper=r}apiUrl="http://localhost:5000/api/projets";currentUserSubject=new c(null);currentUser$=this.currentUserSubject.asObservable();_projetToEdit=null;_isDuplicate=!1;setProjetToEdit(e,t){this._projetToEdit=e,this._isDuplicate=t}getProjetToEdit(){return this._projetToEdit}getIsDuplicate(){return this._isDuplicate}clearProjetToEdit(){this._projetToEdit=null,this._isDuplicate=!1}getAuthHeaders(){return this.authHelper.getAuthHeaders("ProjetsServices")}createProjet(e){return this.getAuthHeaders()?this.http.post(`${this.apiUrl}/creer_projet`,e,this.getAuthHeaders()).pipe(u(t=>{if(t.success&&t.data)return n.fromResponse(t.data);throw new Error(t.message||"Erreur lors de la cr\xE9ation du projet")}),o(t=>this.handleError(t,void 0))):i(null)}updateProjet(e){return this.getAuthHeaders()?this.http.post(`${this.apiUrl}/modifier_projet`,e,this.getAuthHeaders()).pipe(u(t=>{if(t.success&&t.data)return n.fromResponse(t.data);throw new Error(t.message||"Erreur lors de la cr\xE9ation du projet")}),o(t=>this.handleError(t,void 0))):i(null)}findById(e){if(!this.getAuthHeaders())return i(null);let t={idNature:e};return this.http.post(`${this.apiUrl}/obtenir`,t,this.getAuthHeaders()).pipe(u(r=>{if(r.success&&r.data)return n.fromResponse(r.data);throw new Error(r.message||"Projet non trouv\xE9")}),o(r=>this.handleError(r,null)))}deleteProjet(e){if(!this.getAuthHeaders())return i(null);let t={idProjet:e.idProjet};return this.http.post(`${this.apiUrl}/supprimer_projet`,t,this.getAuthHeaders()).pipe(o(r=>this.handleError(r,void 0)))}listProjets(e,t,r,l,p=!1){if(!this.getAuthHeaders())return i(null);let m={page:e,per_page:t,recherche:r,idClient:l,actifOnly:p};return this.http.post(`${this.apiUrl}/lister_projets`,m,this.getAuthHeaders()).pipe(o(b=>this.handleError(b,null)))}restoreProjet(e){return this.getAuthHeaders()?this.http.post(`${this.apiUrl}/restaurer`,{idProjet:e},this.getAuthHeaders()).pipe(u(t=>{if(t.success&&t.data)return n.fromResponse(t.data);throw new Error(t.message||"Erreur lors de la restauration du projet")}),o(t=>this.handleError(t,null))):i(null)}searchProjet(e,t,r,l){if(!this.getAuthHeaders())return i(null);let p={page:e,per_page:t,recherche:r,idClient:l};return this.http.post(`${this.apiUrl}/lister_projets`,p,this.getAuthHeaders()).pipe(o(m=>this.handleError(m,null)))}handleError(e,t){return console.table(e),e.error&&e.error.message&&console.error("Message d'erreur:",e.error.message),e.status===401&&console.warn("Token expir\xE9 ou invalide"),i(t)}static \u0275fac=function(t){return new(t||s)(a(j),a(h),a(P))};static \u0275prov=d({token:s,factory:s.\u0275fac,providedIn:"root"})};export{n as a,f as b};
