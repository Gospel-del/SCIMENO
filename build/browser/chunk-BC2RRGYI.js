import{y as d}from"./chunk-LTEV2KH7.js";import{c as g,q as C}from"./chunk-NKZL4UVF.js";import{B as u,Z as o,ba as i,g as c,l as r,p as s}from"./chunk-S4NM23YD.js";var a=class l{idRegleCalcul;idSousNature;typeCalcul;tauxRegleCalcul;detailRegleCalcul;sous_natures_entree;status;created_at;updated_at;constructor(e){this.idRegleCalcul=e.idRegleCalcul,this.idSousNature=e.idSousNature,this.typeCalcul=e.typeCalcul,this.tauxRegleCalcul=e.tauxRegleCalcul,this.detailRegleCalcul=e.detailRegleCalcul,this.sous_natures_entree=e.sous_natures_entree,this.status=e.status,this.created_at=e.created_at,this.updated_at=e.updated_at}toDict(){return{idRegleCalcul:this.idRegleCalcul,idSousNature:this.idSousNature,typeCalcul:this.typeCalcul,tauxRegleCalcul:this.tauxRegleCalcul,detailRegleCalcul:this.detailRegleCalcul,sous_natures_entree:this.sous_natures_entree,status:this.status,created_at:this.created_at,updated_at:this.updated_at}}getFullName(){return`${this.idSousNature}`}isActive(){return this.status}softDelete(){this.status=!1,this.updated_at=new Date().toISOString()}updateInfo(e){e.idSousNature!==void 0&&(this.idSousNature=e.idSousNature),e.status!==void 0&&(this.status=e.status),e.detailRegleCalcul!==void 0&&(this.detailRegleCalcul=e.detailRegleCalcul),e.typeCalcul!==void 0&&(this.typeCalcul=e.typeCalcul),e.tauxRegleCalcul!==void 0&&(this.tauxRegleCalcul=e.tauxRegleCalcul),e.sous_natures_entree!==void 0&&(this.sous_natures_entree=e.sous_natures_entree),this.updated_at=new Date().toISOString()}isValidate(){let e=[];return(!this.typeCalcul||this.typeCalcul.trim().length===0)&&e.push("Le type est requis"),{isValid:e.length===0,errors:e}}static fromCreateData(e){let t=new Date().toISOString();return new l({idRegleCalcul:0,idSousNature:e.idSousNature,typeCalcul:e.typeCalcul,tauxRegleCalcul:e.tauxRegleCalcul,detailRegleCalcul:e.detailRegleCalcul,sous_natures_entree:e.sous_natures_entree,status:e.status??!0,created_at:t,updated_at:t})}static fromResponse(e){return new l({idRegleCalcul:e.idRegleCalcul,idSousNature:e.idSousNature,typeCalcul:e.typeCalcul,tauxRegleCalcul:e.tauxRegleCalcul,detailRegleCalcul:e.detailRegleCalcul,sous_natures_entree:e.sous_natures_entree,status:e.status,created_at:e.created_at,updated_at:e.updated_at})}};var p=class l{constructor(e,t,n){this.http=e;this.authService=t;this.authHelper=n}apiUrl="http://localhost:5000/api/regle_calcul";currentUserSubject=new c(null);currentUser$=this.currentUserSubject.asObservable();_regleCalculToEdit=null;setRegleCalculToEdit(e){this._regleCalculToEdit=e}getRegleCalculToEdit(){return this._regleCalculToEdit}clearRegleCalculToEdit(){this._regleCalculToEdit=null}getAuthHeaders(){return this.authHelper.getAuthHeaders("RegleCalculService")}createRegleCalcul(e){return this.getAuthHeaders()?this.http.post(`${this.apiUrl}/creer`,e,this.getAuthHeaders()).pipe(s(t=>{if(t.success&&t.data)return a.fromResponse(t.data);throw new Error(t.message||"Erreur lors de la cr\xE9ation de la r\xE8gle")}),u(t=>this.handleError(t,void 0))):r(null)}updateRegleCalcul(e){return this.getAuthHeaders()?this.http.post(`${this.apiUrl}/modifier`,e,this.getAuthHeaders()).pipe(s(t=>{if(t.success&&t.data)return a.fromResponse(t.data);throw new Error(t.message||"Erreur lors de la modification de la nature")}),u(t=>this.handleError(t,void 0))):r(null)}deleteRegleCalcul(e){return this.getAuthHeaders()?this.http.post(`${this.apiUrl}/supprimer`,e,this.getAuthHeaders()).pipe(s(t=>a.fromResponse(t)),u(t=>this.handleError(t,void 0))):r(null)}listRegleCalculs(e,t,n,R){if(!this.getAuthHeaders())return r(null);let h={page:e,per_page:t,typeNature:n,idSousNature:R};return this.http.post(`${this.apiUrl}/lister`,h,this.getAuthHeaders())}handleError(e,t){return console.table(e),e.error&&e.error.message&&console.error("Message d'erreur:",e.error.message),e.status===401&&console.warn("Token expir\xE9 ou invalide"),r(t)}static \u0275fac=function(t){return new(t||l)(i(g),i(C),i(d))};static \u0275prov=o({token:l,factory:l.\u0275fac,providedIn:"root"})};export{a,p as b};
